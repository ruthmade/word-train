<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#F5F1E8">
    <title>Word Train | ruthmade</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', 'Helvetica', sans-serif;
            background: linear-gradient(135deg, #F5F1E8 0%, #E8DCC8 100%);
            color: #4A4238;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding-top: 40px;
        }

        .train-area {
            position: relative;
            margin-bottom: 60px;
            height: 200px;
        }

        .signal {
            position: absolute;
            left: 20px;
            top: 20px;
            width: 30px;
            height: 90px;
            background: #4A4238;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around;
            padding: 10px 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .signal::before,
        .signal::after {
            content: '';
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #D4A895;
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }

        /* Top lamp - red */
        .signal::before {
            background: #D4A895;
        }

        /* Bottom lamp - red by default */
        .signal::after {
            background: #D4A895;
        }

        /* Bottom lamp turns green and glows */
        .signal.green::after {
            background: #B8C5B0;
            box-shadow: 
                inset 0 2px 4px rgba(0,0,0,0.2),
                0 0 15px rgba(184, 197, 176, 0.8),
                0 0 25px rgba(184, 197, 176, 0.5);
        }

        .train-container {
            position: absolute;
            left: 0;
            right: 0;
            top: 50px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 10px;
            transition: transform 1.5s ease-in-out;
        }

        .train-container.drive-in {
            animation: driveIn 1.5s ease-out;
        }

        .train-container.drive-off {
            transform: translateX(-150%);
        }

        @keyframes driveIn {
            from {
                transform: translateX(150%);
            }
            to {
                transform: translateX(0);
            }
        }

        .engine {
            font-size: 3em;
        }

        .car {
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.9);
            border: 4px solid #8FA39A;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            font-weight: bold;
            color: #4A4238;
            position: relative;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .car.celebrate {
            animation: celebrate 0.6s ease;
        }

        @keyframes celebrate {
            0%, 100% { transform: translateY(0) scale(1); }
            25% { transform: translateY(-15px) scale(1.05); }
            50% { transform: translateY(0) scale(1); }
            75% { transform: translateY(-8px) scale(1.02); }
        }

        .sparkle {
            position: absolute;
            font-size: 1.2em;
            animation: sparkleFloat 1.2s ease-out forwards;
            pointer-events: none;
            z-index: 10;
            opacity: 0.8;
        }

        @keyframes sparkleFloat {
            0% {
                opacity: 0.8;
                transform: translate(-50%, 0) scale(0.5);
            }
            50% {
                opacity: 0.6;
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -60px) scale(0.8) rotate(90deg);
            }
        }

        .car.empty {
            background: rgba(255, 255, 255, 0.5);
            border-style: dashed;
        }

        .remove-btn {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(143, 163, 154, 0.4);
            border: 2px solid #8FA39A;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            font-size: 1em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4A4238;
            font-weight: bold;
        }

        .remove-btn:active {
            transform: translateX(-50%) scale(0.9);
        }

        .track {
            width: 100%;
            height: 4px;
            background: #8FA39A;
            border-radius: 2px;
            position: absolute;
            bottom: 40px;
        }

        .letter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
            gap: 12px;
            max-width: 600px;
            margin: 0 auto;
        }

        .letter-btn {
            width: 100%;
            aspect-ratio: 1;
            min-height: 70px;
            font-size: 2em;
            font-weight: bold;
            border: 3px solid;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #4A4238;
            font-family: 'Arial', sans-serif;
        }

        .letter-btn.consonant {
            background: rgba(143, 163, 154, 0.3);
            border-color: #8FA39A;
        }

        .letter-btn.vowel {
            background: rgba(212, 168, 149, 0.3);
            border-color: #D4A895;
        }

        .letter-btn:active {
            transform: scale(0.95);
        }

        .letter-btn:hover {
            filter: brightness(1.1);
        }

        footer {
            text-align: center;
            margin-top: 40px;
            font-size: 0.85em;
            color: #8FA39A;
        }

        footer a {
            color: #8FA39A;
            text-decoration: none;
            border-bottom: 1px solid #B8C5B0;
        }

        @media (max-width: 480px) {
            .car {
                width: 80px;
                height: 80px;
                font-size: 2.2em;
            }

            .engine {
                font-size: 2.5em;
            }

            .letter-grid {
                grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
                gap: 10px;
            }

            .letter-btn {
                min-height: 60px;
                font-size: 1.8em;
            }

            .signal {
                width: 25px;
                height: 70px;
            }

            .signal::before,
            .signal::after {
                width: 16px;
                height: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="train-area">
            <div class="signal" id="signal"></div>
            <div class="train-container drive-in" id="train">
                <div class="engine">ðŸš‚</div>
                <div class="car empty" id="car0">
                    <span class="letter"></span>
                </div>
                <div class="car empty" id="car1">
                    <span class="letter"></span>
                </div>
                <div class="car empty" id="car2">
                    <span class="letter"></span>
                </div>
            </div>
            <div class="track"></div>
        </div>

        <div class="letter-grid" id="letters"></div>
    </div>

    <footer>
        Made with care by <a href="https://x.com/rubyruth" target="_blank" rel="noopener">@rubyruth</a>
    </footer>

    <script>
        // All valid 3-letter words (includes CVC, CVCe, digraphs, blends, sight words, etc)
        const validWords = [
            // CVC a words
            'van', 'cab', 'can', 'man', 'ran', 'fan', 'pan', 'tan', 'bad', 'dad',
            'had', 'mad', 'sad', 'lad', 'pad', 'bag', 'tag', 'wag', 'bat', 'cat',
            'hat', 'mat', 'pat', 'rat', 'sat', 'vat', 'fat', 'dab', 'gab', 'jab',
            'lab', 'nab', 'tab', 'dam', 'ham', 'jam', 'ram', 'yam', 'cap', 'gap',
            'lap', 'map', 'nap', 'rap', 'sap', 'tap', 'zap', 'gas', 'pal', 'wax',
            'max', 'tax', 'fax', 'was', 'has',
            // CVCe and other a patterns
            'ace', 'age', 'ape', 'are', 'ate', 'ave', 'awe', 'axe', 'aye', 'all',
            'and', 'ant', 'any', 'apt', 'arc', 'ark', 'arm', 'art', 'ash', 'ask',
            'add', 'aid', 'aim', 'air', 'ale', 'amp', 'act',
            // CVC e words
            'bed', 'red', 'led', 'fed', 'wed', 'beg', 'leg', 'peg', 'ben', 'den',
            'hen', 'men', 'pen', 'ten', 'bet', 'get', 'jet', 'let', 'met', 'net',
            'pet', 'set', 'vet', 'wet', 'yet', 'pep', 'web', 'pew',
            // Other e patterns
            'ear', 'eat', 'egg', 'elf', 'elk', 'elm', 'emu', 'end', 'era', 'err',
            'eve', 'ewe', 'eye', 'ebb',
            // CVC i words
            'bid', 'did', 'hid', 'kid', 'lid', 'rid', 'big', 'dig', 'fig', 'gig',
            'jig', 'pig', 'wig', 'bin', 'din', 'fin', 'kin', 'pin', 'sin', 'tin',
            'win', 'bit', 'fit', 'hit', 'kit', 'lit', 'pit', 'sit', 'wit', 'dip',
            'hip', 'lip', 'nip', 'rip', 'sip', 'tip', 'zip', 'dim', 'him', 'rim',
            'fix', 'mix', 'six', 'rib', 'bib',
            // Other i patterns
            'ice', 'ill', 'imp', 'ink', 'inn', 'ion', 'its', 'ivy',
            // CVC o words
            'bog', 'cog', 'dog', 'fog', 'hog', 'jog', 'log', 'box', 'fox', 'not',
            'cot', 'dot', 'got', 'hot', 'lot', 'pot', 'rot', 'tot', 'cop', 'hop',
            'mop', 'pop', 'top', 'bob', 'cob', 'job', 'mob', 'rob', 'sob', 'god',
            'nod', 'pod', 'rod', 'sod', 'mom', 'tom',
            // Other o patterns
            'oak', 'oar', 'oat', 'odd', 'ode', 'off', 'oft', 'oil', 'old', 'one',
            'opt', 'orb', 'ore', 'our', 'out', 'owe', 'owl', 'own', 'ox',
            // CVC u words
            'bud', 'cud', 'mud', 'bug', 'dug', 'hug', 'jug', 'mug', 'pug', 'rug',
            'tug', 'bun', 'fun', 'gun', 'nun', 'pun', 'run', 'sun', 'but', 'cut',
            'gut', 'hut', 'jut', 'nut', 'rut', 'bus', 'cub', 'hub', 'pub', 'rub',
            'sub', 'tub', 'bum', 'gum', 'hum', 'sum', 'yum', 'cup', 'pup', 'sup',
            'put',
            // Other u patterns
            'urn', 'use', 'ugh',
            // Digraphs and other patterns
            'the', 'she', 'who', 'why', 'how', 'now', 'new', 'few', 'sew', 'dew',
            'cow', 'bow', 'row', 'low', 'sow', 'tow', 'vow', 'wow', 'two', 'see',
            'bee', 'fee', 'pee', 'tea', 'sea', 'pea', 'too', 'zoo', 'boo', 'coo',
            'goo', 'moo', 'woo', 'shh', 'shy', 'sky', 'spy', 'try', 'dry', 'fry',
            'cry', 'pry', 'way', 'bay', 'day', 'hay', 'jay', 'lay', 'may', 'pay',
            'ray', 'say', 'toy', 'boy', 'coy', 'joy', 'soy', 'car', 'bar', 'far',
            'jar', 'tar', 'war', 'for', 'nor', 'fur', 'our', 'her', 'per', 'sir',
            'pal', 'gal', 'gnu', 'psi', 'chi', 'phi', 'you', 'yes', 'yep', 'yak',
            'yen', 'yew'
        ];

        const vowels = ['a', 'e', 'i', 'o', 'u'];
        const consonants = ['b', 'c', 'd', 'f', 'g', 'h', 'j', 'k', 'l', 'm', 'n', 'p', 'r', 's', 't', 'v', 'w', 'x', 'z'];
        
        let currentWord = ['', '', ''];
        let isAnimating = false;

        // Create letter buttons
        function createLetterGrid() {
            const grid = document.getElementById('letters');
            
            // Mix consonants and vowels
            const allLetters = [...consonants.slice(0, 9), ...vowels, ...consonants.slice(9)];
            
            allLetters.forEach(function(letter) {
                const btn = document.createElement('button');
                btn.className = vowels.includes(letter) ? 'letter-btn vowel' : 'letter-btn consonant';
                btn.textContent = letter;
                btn.onclick = function() { addLetter(letter); };
                grid.appendChild(btn);
            });
        }

        function addLetter(letter) {
            if (isAnimating) return;
            
            // Find next empty spot
            for (let i = 0; i < 3; i++) {
                if (currentWord[i] === '') {
                    currentWord[i] = letter;
                    updateDisplay();
                    checkWord();
                    return;
                }
            }
        }

        function removeLetter(index) {
            if (isAnimating) return;
            currentWord[index] = '';
            updateDisplay();
        }

        function updateDisplay() {
            for (let i = 0; i < 3; i++) {
                const car = document.getElementById('car' + i);
                const letter = currentWord[i];
                
                if (letter) {
                    car.classList.remove('empty');
                    car.querySelector('.letter').textContent = letter;
                    
                    // Add remove button if not present
                    if (!car.querySelector('.remove-btn')) {
                        const removeBtn = document.createElement('button');
                        removeBtn.className = 'remove-btn';
                        removeBtn.textContent = 'x';
                        removeBtn.onclick = function() { removeLetter(i); };
                        car.appendChild(removeBtn);
                    }
                } else {
                    car.classList.add('empty');
                    car.querySelector('.letter').textContent = '';
                    const removeBtn = car.querySelector('.remove-btn');
                    if (removeBtn) removeBtn.remove();
                }
            }
        }

        function checkWord() {
            const word = currentWord.join('');
            
            if (word.length === 3 && validWords.includes(word)) {
                celebrateWord();
            }
        }

        function celebrateWord() {
            isAnimating = true;
            const signal = document.getElementById('signal');
            const train = document.getElementById('train');
            
            // Add celebrate animation to all cars
            for (let i = 0; i < 3; i++) {
                const car = document.getElementById('car' + i);
                car.classList.add('celebrate');
                
                // Add sparkles
                const sparkles = ['âœ¨', 'â­', 'ðŸ’«'];
                for (let j = 0; j < 2; j++) {
                    setTimeout(function() {
                        const sparkle = document.createElement('div');
                        sparkle.className = 'sparkle';
                        sparkle.textContent = sparkles[Math.floor(Math.random() * sparkles.length)];
                        sparkle.style.left = '50%';
                        sparkle.style.top = '20px';
                        sparkle.style.animationDelay = (j * 0.2) + 's';
                        car.appendChild(sparkle);
                        
                        setTimeout(function() {
                            sparkle.remove();
                        }, 1200);
                    }, j * 150);
                }
            }
            
            // Turn signal green
            signal.classList.add('green');
            
            // Play choo sound (simple beep using Web Audio API)
            playChoo();
            
            // Wait a moment, then drive off
            setTimeout(function() {
                train.classList.add('drive-off');
                
                // After train leaves, bring in new train
                setTimeout(function() {
                    resetTrain();
                }, 1500);
            }, 800);
        }

        function playChoo() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 400;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }

        function resetTrain() {
            const train = document.getElementById('train');
            const signal = document.getElementById('signal');
            
            // Reset position without animation
            train.classList.remove('drive-off');
            train.style.transition = 'none';
            train.style.transform = 'translateX(150%)';
            
            // Reset word
            currentWord = ['', '', ''];
            updateDisplay();
            
            // Turn signal red
            signal.classList.remove('green');
            
            // Force reflow
            train.offsetHeight;
            
            // Re-enable transition and drive in
            train.style.transition = '';
            train.style.transform = '';
            train.classList.add('drive-in');
            
            setTimeout(function() {
                train.classList.remove('drive-in');
                isAnimating = false;
            }, 1500);
        }

        // Keyboard support
        document.addEventListener('keydown', function(event) {
            const key = event.key.toLowerCase();
            if (vowels.includes(key) || consonants.includes(key)) {
                addLetter(key);
            } else if (key === 'backspace') {
                // Remove last filled letter
                for (let i = 2; i >= 0; i--) {
                    if (currentWord[i] !== '') {
                        removeLetter(i);
                        break;
                    }
                }
            }
        });

        // Initialize
        createLetterGrid();
    </script>
</body>
</html>
